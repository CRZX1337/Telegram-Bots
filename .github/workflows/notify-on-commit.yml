name: Enhanced Commit Notification

on: [push]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Fetch commit details
        id: commit-details
        run: |
          # Extrahiere DateiÃ¤nderungen aus dem GitHub-Event
          ADDED=$(echo '${{ toJSON(github.event.commits[0].added) }}' | jq length)
          MODIFIED=$(echo '${{ toJSON(github.event.commits[0].modified) }}' | jq length)
          REMOVED=$(echo '${{ toJSON(github.event.commits[0].removed) }}' | jq length)
          
          # Speichere die Daten fÃ¼r die Nachricht
          echo "::set-output name=added::$ADDED"
          echo "::set-output name=modified::$MODIFIED"
          echo "::set-output name=removed::$REMOVED"

      - name: Send detailed message
        run: |
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
          -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
          -d "parse_mode=MarkdownV2" \
          -d "text=ğŸ“Œ **New Commit to \`${{ github.repository }}\`** 

          ğŸ”¹ **Branch**: \`${{ github.ref }}\`  
          ğŸ‘¤ **Author**: ${{ github.actor }}  
          ğŸ•’ **Timestamp**: \`${{ github.event.head_commit.timestamp }}\`  
          ğŸ“ **Message**:  
          \`\`\`  
          ${{ github.event.head_commit.message }}  
          \`\`\`  

          ğŸ“‚ **Files Changed**:  
          â• Added: ${{ steps.commit-details.outputs.added }}  
          âœï¸ Modified: ${{ steps.commit-details.outputs.modified }}  
          ğŸ—‘ï¸ Removed: ${{ steps.commit-details.outputs.removed }}  

          ğŸ”— [Compare Changes](${{ github.event.compare }})"
